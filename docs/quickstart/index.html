
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Quickstart - LatentLego</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="amber">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quickstart" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="LatentLego" class="md-header-nav__button md-logo" aria-label="LatentLego">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            LatentLego
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Quickstart
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link md-tabs__link--active">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../api/models/Autoencoder/" class="md-tabs__link">
        API Reference
      </a>
    </li>
  

  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../notebooks/integration/" class="md-tabs__link">
        Notebooks
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LatentLego" class="md-nav__button md-logo" aria-label="LatentLego">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    LatentLego
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Home
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Home" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      About
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Quickstart
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Quickstart
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-pre-defined-models" class="md-nav__link">
    Using pre-defined models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-models-by-combining-encoder-and-decoder" class="md-nav__link">
    Defining models by combining encoder and decoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-autoencoders-from-scratch" class="md-nav__link">
    Building autoencoders from scratch
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    
    <label class="md-nav__link" for="nav-2">
      API Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" >
    
    <label class="md-nav__link" for="nav-2-1">
      models
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="models" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        <span class="md-nav__icon md-icon"></span>
        models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1-1" type="checkbox" id="nav-2-1-1" >
    
    <label class="md-nav__link" for="nav-2-1-1">
      ae
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ae" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-1">
        <span class="md-nav__icon md-icon"></span>
        ae
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/Autoencoder/" class="md-nav__link">
      Autoencoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/PoissonAutoencoder/" class="md-nav__link">
      PoissonAutoencoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/NegativeBinomialAutoencoder/" class="md-nav__link">
      NegativeBinomialAutoencoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/ZINBAutoencoder/" class="md-nav__link">
      ZINBAutoencoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/TopologicalAutoencoder/" class="md-nav__link">
      TopologicalAutoencoder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1-2" type="checkbox" id="nav-2-1-2" >
    
    <label class="md-nav__link" for="nav-2-1-2">
      vae
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="vae" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-2">
        <span class="md-nav__icon md-icon"></span>
        vae
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/VariationalAutoencoder/" class="md-nav__link">
      VariationalAutoencoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/PoissonVAE/" class="md-nav__link">
      PoissonVAE
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/NegativeBinomialVAE/" class="md-nav__link">
      NegativeBinomialVAE
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/ZINBVAE/" class="md-nav__link">
      ZINBVAE
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/TopologicalVariationalAutoencoder/" class="md-nav__link">
      TopologicalVariationalAutoencoder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1-3" type="checkbox" id="nav-2-1-3" >
    
    <label class="md-nav__link" for="nav-2-1-3">
      twae
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="twae" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-3">
        <span class="md-nav__icon md-icon"></span>
        twae
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/models/TwinAutoencoder/" class="md-nav__link">
      TwinAutoencoder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2" >
    
    <label class="md-nav__link" for="nav-2-2">
      modules
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="modules" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon"></span>
        modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2-1" type="checkbox" id="nav-2-2-1" >
    
    <label class="md-nav__link" for="nav-2-2-1">
      encoder
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="encoder" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-1">
        <span class="md-nav__icon md-icon"></span>
        encoder
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/Encoder/" class="md-nav__link">
      Encoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/VariationalEncoder/" class="md-nav__link">
      VariationalEncoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/TopologicalEncoder/" class="md-nav__link">
      TopologicalEncoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/TopologicalVariationalEncoder/" class="md-nav__link">
      TopologicalVariationalEncoder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2-2" type="checkbox" id="nav-2-2-2" >
    
    <label class="md-nav__link" for="nav-2-2-2">
      decoder
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="decoder" data-md-level="3">
      <label class="md-nav__title" for="nav-2-2-2">
        <span class="md-nav__icon md-icon"></span>
        decoder
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/Decoder/" class="md-nav__link">
      Decoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/PoissonDecoder/" class="md-nav__link">
      PoissonDecoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/NegativeBinomialDecoder/" class="md-nav__link">
      NegativeBinomialDecoder
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/modules/ZINBDecoder/" class="md-nav__link">
      ZINBDecoder
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" >
    
    <label class="md-nav__link" for="nav-2-3">
      activations
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="activations" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        activations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/activations/clipped_exp/" class="md-nav__link">
      clipped_exp
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/activations/clipped_softplus/" class="md-nav__link">
      clipped_softplus
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/activations/get/" class="md-nav__link">
      get
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" >
    
    <label class="md-nav__link" for="nav-2-4">
      layers
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="layers" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon"></span>
        layers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/DenseBlock/" class="md-nav__link">
      DenseBlock
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/DenseStack/" class="md-nav__link">
      DenseStack
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/RowwiseMult/" class="md-nav__link">
      RowwiseMult
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/SharedDispersion/" class="md-nav__link">
      SharedDispersion
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/Constant/" class="md-nav__link">
      Constant
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/layers/PseudoInputs/" class="md-nav__link">
      PseudoInputs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5" >
    
    <label class="md-nav__link" for="nav-2-5">
      losses
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="losses" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon"></span>
        losses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/losses/NegativeBinomial/" class="md-nav__link">
      NegativeBinomial
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/losses/ZINB/" class="md-nav__link">
      ZINB
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/losses/MaximumMeanDiscrepancy/" class="md-nav__link">
      MaximumMeanDiscrepancy
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/losses/TopologicalSignatureDistance/" class="md-nav__link">
      TopologicalSignatureDistance
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/losses/get/" class="md-nav__link">
      get
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6" >
    
    <label class="md-nav__link" for="nav-2-6">
      callbacks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="callbacks" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        callbacks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../api/callbacks/IncreaseKLDOnEpoch/" class="md-nav__link">
      IncreaseKLDOnEpoch
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../api/callbacks/KLDivergenceScheduler/" class="md-nav__link">
      KLDivergenceScheduler
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      Notebooks
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Notebooks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../notebooks/integration/" class="md-nav__link">
      Integration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-pre-defined-models" class="md-nav__link">
    Using pre-defined models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-models-by-combining-encoder-and-decoder" class="md-nav__link">
    Defining models by combining encoder and decoder
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-autoencoders-from-scratch" class="md-nav__link">
    Building autoencoders from scratch
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="quickstart">Quickstart</h1>
<p>LatentLego is like a lego box with building blocks for autoencoders. These building blocks are hierarchically assembled into larger components, each of which can be used in a modular way to define a model. To make this more clear, lets start with some examples.</p>
<h2 id="using-pre-defined-models">Using pre-defined models</h2>
<p>LatentLego hosts a model zoo with a number of common autoencoder architectures ready to use. They are subclassed Keras <code>Model</code> objects and understand common methods like <code>.fit()</code> and <code>.predict()</code>. So the quickest way to train an autoencoder with LatentLego is simply</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">latent.models</span> <span class="kn">import</span> <span class="n">Autoencoder</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)])</span>

<span class="c1"># Creates an autoencoder model with a 2-dimensional latent space</span>
<span class="n">ae</span> <span class="o">=</span> <span class="n">Autoencoder</span><span class="p">(</span><span class="n">latent_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_dim</span><span class="o">=</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>

<span class="c1"># Compiled the model with a poisson loss and a Adam optimizer</span>
<span class="n">ae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">)</span>

<span class="c1"># Trains the model on x_train</span>
<span class="n">ae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<p>This trained autoencoder model can now be used to yield a low dimensional representation of the input (or new) data. In line with the <a href="https://scikit-learn.org/">scikit-learn</a> API, autoencoder models in LatentLego have a <code>.transform()</code> method, which returns the low dimensional representation.</p>
<div class="highlight"><pre><span></span><code><span class="n">x_latent</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</code></pre></div>
<p>Using <code>.predict()</code> gives us the reconstructred input data after being passed through the bottleneck. This representation can be used for denoising of single-cell data (<a href="https://www.nature.com/articles/s41467-018-07931-2">Erslan 2019</a>).</p>
<div class="highlight"><pre><span></span><code><span class="n">x_recon</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</code></pre></div>
<h2 id="defining-models-by-combining-encoder-and-decoder">Defining models by combining encoder and decoder</h2>
<p>The second way to define a model with LatentLego is to pick any of the provided <code>encoder</code> and <code>decoder</code> models and combine them using the <code>Autoencoder</code> data structure. For instance, if you want to create a variational autoencoder with a negative binomial reconstruction loss you can simply combine a <code>VariationalEncoder</code> with a <code>NegativeBinomialDecoder</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">latent.modules</span> <span class="kn">import</span> <span class="n">VariationalEncoder</span><span class="p">,</span> <span class="n">NegativeBinomialDecoder</span>

<span class="c1"># Creates a VariationalEncoder with a standard normal prior</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">VariationalEncoder</span><span class="p">(</span><span class="n">latent_dim</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">kld_weight</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="c1"># Creates a NegativeBinomialDecoder with a constant dispersion estimate</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">NegativeBinomialDecoder</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dispersion</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>

<span class="c1"># Constructs an Autoencoder object with predefined encoder and decoder</span>
<span class="n">ae</span> <span class="o">=</span> <span class="n">Autoencoder</span><span class="p">(</span>
    <span class="n">encoder</span><span class="o">=</span><span class="n">encoder</span><span class="p">,</span>
    <span class="n">decoder</span><span class="o">=</span><span class="n">decoder</span>
<span class="p">)</span>
<span class="n">ae</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>

<span class="c1"># Fit input data using size factors for each cell</span>
<span class="n">x_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ae</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_sf</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<p>You might have noticed that this time we did not define a loss function. This is because some encoder and decoder models take care of the model loss on their own. Generally in LatentLego, encoders are responsible for adding losses related to the latent space, such as the KLDivergence loss of a VAE and decoders add the reconstruction loss. If you anyway decide to pass a loss function to <code>.compile()</code> it will be added to the reconstruction loss defined by the decoder.</p>
<p>The <code>Autoencoder</code> data structure subclasses the Keras <code>Model</code> and takes care of providing additional methods like <code>.transform()</code> and handling cases with multiple inputs like conditions or size factors. But since <code>encoder</code> and <code>decoder</code> models are just Keras <code>Model</code> objects themselves, they can also be used with the Keras Functional API:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">latent.modules</span> <span class="kn">import</span> <span class="n">Encoder</span><span class="p">,</span> <span class="n">Decoder</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],))</span>
<span class="n">x_latent</span> <span class="o">=</span> <span class="n">Encoder</span><span class="p">(</span><span class="n">latent_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Decoders take the latent and the original data space as the input</span>
<span class="c1"># so they can add the reconstruction loss</span>
<span class="n">x_rec</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_latent</span><span class="p">])</span>
<span class="n">ae</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">x_rec</span><span class="p">)</span>

<span class="n">ae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">run_eagerly</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<h2 id="building-autoencoders-from-scratch">Building autoencoders from scratch</h2>
<p>Lastly, if you want to implement a model that can not be directly assembled in LatentLego, you may want to implement the encoder/decoder or both from scratch. For this, we also provide some convenient lower-level components that extend the reportoire of Keras and TensorFlow. For instance, the <code>DenseStack</code> layer strings together a sequence of <code>DenseBlock</code> layers and take care of batch normalization, dropout and conditional injection. We can combine it with some <a href="https://www.tensorflow.org/probability">TensorFlow Probability</a> magic and stack it on top of a <code>NegativeBinomialDecoder</code> to obtain a VAE with negative binomial loss.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">import</span> <span class="nn">tensorflow_probability</span> <span class="k">as</span> <span class="nn">tfp</span>
<span class="n">tfpl</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">layers</span>
<span class="n">tfd</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span>
<span class="kn">from</span> <span class="nn">latent.layers</span> <span class="kn">import</span> <span class="n">DenseStack</span>
<span class="kn">from</span> <span class="nn">latent.modules</span> <span class="kn">import</span> <span class="n">NegativeBinomialDecoder</span>

<span class="n">latent_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Initiate standard normal prior</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">tfd</span><span class="o">.</span><span class="n">Independent</span><span class="p">(</span><span class="n">tfd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">reinterpreted_batch_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Construct encoder with sequential model</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">DenseStack</span><span class="p">(</span><span class="n">hidden_units</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">56</span><span class="p">],</span> <span class="n">batchnorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropout_rate</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
        <span class="n">tfpl</span><span class="o">.</span><span class="n">MultivariateNormalTriL</span><span class="o">.</span><span class="n">params_size</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">),</span>
        <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">),</span>
    <span class="n">tfpl</span><span class="o">.</span><span class="n">MultivariateNormalTriL</span><span class="p">(</span>
        <span class="n">latent_dim</span><span class="p">,</span>
        <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">tfpl</span><span class="o">.</span><span class="n">KLDivergenceRegularizer</span><span class="p">(</span><span class="n">prior</span><span class="p">))</span>
<span class="p">])</span>
<span class="c1"># Initiate a NB decoder with a per-gene dispersion estimate</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">NegativeBinomialDecoder</span><span class="p">(</span><span class="n">x_dim</span><span class="o">=</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dispersion</span><span class="o">=</span><span class="s1">&#39;gene&#39;</span><span class="p">)</span>

<span class="n">x_in</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],))</span>
<span class="n">sf_in</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
<span class="n">x_latent</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">x_in</span><span class="p">)</span>
<span class="n">x_rec</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">([</span><span class="n">x_in</span><span class="p">,</span> <span class="n">x_latent</span><span class="p">,</span> <span class="n">sf_in</span><span class="p">])</span>
<span class="n">nbvae</span> <span class="o">=</span> <span class="n">Model</span><span class="p">([</span><span class="n">x_in</span><span class="p">,</span> <span class="n">sf_in</span><span class="p">],</span> <span class="n">x_rec</span><span class="p">)</span>

<span class="c1"># We specify no loss because NB loss is handled by the decoder</span>
<span class="n">nbvae</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">)</span>
<span class="n">nbvae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_sf</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">x_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                About
              </div>
            </div>
          </a>
        
        
          <a href="../api/models/Autoencoder/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Autoencoder
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>